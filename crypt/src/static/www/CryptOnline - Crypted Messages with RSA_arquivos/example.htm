<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0052)http://www.mycgiserver.com/~cryptonline/example.html -->
<HTML><HEAD><TITLE>CriptOnline - Mensagens criptografadas com RSA</TITLE><!-- #BeginTemplate "/Templates/default.dwt" --><!-- DW6 --><!-- #BeginEditable "doctitle" --><!-- #EndEditable -->
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1"><LINK 
href="example_arquivos/estilo.css" type=text/css rel=stylesheet><LINK 
href="example_arquivos/graw.css" type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2800.1515" name=GENERATOR></HEAD>
<BODY leftMargin=0 background=example_arquivos/background.jpg topMargin=0><BR>
<TABLE class=tabelaMaior height=486 cellSpacing=2 cellPadding=1 width=770 
align=center border=0>
  <TBODY>
  <TR>
    <TD colSpan=2 height=48>
      <P><B><FONT size=5>CryptOnline - <FONT size=4>Crypted messages with <IMG 
      height=43 src="example_arquivos/rsa.gif" width=100 
      align=absMiddle></FONT></FONT></B></P></TD></TR>
  <TR class=escuro>
    <TD width=652 height=21><FONT face=verdana color=white size=2><B><!-- #BeginEditable "title" -->Main Page :: Example<!-- #EndEditable --></B></FONT></TD>
    <TD width=108 height=21>
      <DIV align=center><A style="COLOR: #ffffff" 
      href="http://www.mycgiserver.com/~cryptonline/index.jsp"><B>Main Page 
      </B></A></DIV></TD></TR>
  <TR vAlign=top>
    <TD colSpan=2 height=350><!-- #BeginEditable "centro" -->
      <P>Here will demostrate with an example how the real algorithm works... 
      It's demonstrate here the 3 spets used: Generating the keys, sending a 
      message, receiving a message. We'll encode my name Marcello Alves de Sales 
      Junior</P>
      <UL>
        <LI>Generating the keys </LI></UL><PRE>-&gt; Setting Prime numbers
        P = 499
        Q = 2683

-&gt; Calculating Your Public key 

          N = P * Q; N = 1338817
  	  FI = (P-1) * (Q-1); FI = 1335636

-&gt; Calculating (E)
           While gcd(n &gt;= 2 , 1335636) != 1
           gcd(2 , 1335636) = 2
           gcd(3 , 1335636) = 3
           gcd(4 , 1335636) = 4
           gcd(5 , 1335636) = 1 Correto!
          E = 5

Public Key (N,E) = (1338817 , 5)

-&gt; Calculating Your Private key 

         Initialize (p1,p2,p3) = (1, 0 , FI(n))
         Initialize (q1,q2,q3) = (0, 1 ,  E ))
         While q3 != 0
             quoc = p3 / q3
             (t1,t2,t3) = (p1,p2,p3) - quoc * (q1,q2,q3)
             Give Values:
             (p1,p2,p3) = (q1,q2,q3)
             (q1,q2,q3) = (t1,t2,t3)

           (5 &lt;&gt; 0) , then:
             quoc = 1335636 / 5 = 267127
             (t1,t2,t3) = (0,1,5) - 267127 * (1,-267127,1) = (1,-267127,1)
             (p1,p2,p3) = (1,-267127,1)
             (q1,q2,q3) = (1,-267127,1)

           (1 &lt;&gt; 0) , then:
             quoc = 5 / 1 = 5
             (t1,t2,t3) = (1,-267127,1) - 5 * (-5,1335636,0) = (-5,1335636,0)
             (p1,p2,p3) = (-5,1335636,0)
             (q1,q2,q3) = (-5,1335636,0)

         q3 is zero(0). Now we verify the p2 value . In case of a negative number, 
		 we sum it with FI. (represent the negative number of z(n) by a positive one)

         u2 = -267127;
         As u2 is a negative number,:
         D = u2 + FI; D = -267127 + 1335636 = 1068509

      Private Key (N,D) = (1338817,1068509);
</PRE>
      <UL>
        <LI>Key Information </LI></UL><PRE>Prime P: 499.0
Prime Q: 2683.0

Public Key (N, E) = (1338817.0, 5.0)
Private Key (N, D) = (1338817.0, 1068509.0)

</PRE>
      <UL>
        <LI>Sending message </LI></UL><PRE>
-&gt; Original Message
Marcello Alves de Sales Junior

-&gt; Setting public keys of the receiver
(N , E) = (1338817 , 5)

-&gt; Translate the message to its ASCII representation
177197214199201208208211132165208218201215132200201132183197208201215132174217210205211214

-&gt; Encode random blocks
Block(x) = x ^ E mod N

Block(1771) = 1771 ^ 5 mod 1338817 = 333701
Block(9) = 9 ^ 5 mod 1338817 = 59049
Block(72) = 72 ^ 5 mod 1338817 = 327067
Block(14) = 14 ^ 5 mod 1338817 = 537824
Block(19) = 19 ^ 5 mod 1338817 = 1137282
Block(920) = 920 ^ 5 mod 1338817 = 178853
Block(120) = 120 ^ 5 mod 1338817 = 1286055
Block(820) = 820 ^ 5 mod 1338817 = 183268
Block(82111) = 82111 ^ 5 mod 1338817 = 535308
Block(3216) = 3216 ^ 5 mod 1338817 = 19010
Block(520) = 520 ^ 5 mod 1338817 = 592598
Block(821820) = 821820 ^ 5 mod 1338817 = 58063
Block(1215) = 1215 ^ 5 mod 1338817 = 324526
Block(132) = 132 ^ 5 mod 1338817 = 1171988
Block(200) = 200 ^ 5 mod 1338817 = 1315928
Block(201) = 201 ^ 5 mod 1338817 = 617517
Block(1321) = 1321 ^ 5 mod 1338817 = 769804
Block(831) = 831 ^ 5 mod 1338817 = 974859
Block(97) = 97 ^ 5 mod 1338817 = 168019
Block(208) = 208 ^ 5 mod 1338817 = 945168
Block(20121) = 20121 ^ 5 mod 1338817 = 1280538
Block(51) = 51 ^ 5 mod 1338817 = 949282
Block(32174) = 32174 ^ 5 mod 1338817 = 773115
Block(2172) = 2172 ^ 5 mod 1338817 = 1191266
Block(1020) = 1020 ^ 5 mod 1338817 = 261935
Block(52) = 52 ^ 5 mod 1338817 = 1318821
Block(1) = 1 ^ 5 mod 1338817 = 1
Block(12) = 12 ^ 5 mod 1338817 = 248832
Block(14) = 14 ^ 5 mod 1338817 = 537824

-&gt; Encrypted Message
333701-59049-327067-537824-1137282-178853-1286055-183268-535308-19010-592598-58063-324526
-1171988-1315928-617517-769804-974859-168019-945168-1280538-949282-773115-1191266-261935
-1318821-1-248832-537824

</PRE>
      <UL>
        <LI>Receiving a message </LI></UL><PRE>
-&gt; Mensagem Criptografada
333701-59049-327067-537824-1137282-178853-1286055-183268-535308-19010-592598-58063-324526
-1171988-1315928-617517-769804-974859-168019-945168-1280538-949282-773115-1191266-261935
-1318821-1-248832-537824

-&gt; Setting the private key
(N , D) = (1338817 , 1068509)

-&gt; Decoding each block
Ascii(x) = x ^ D mod N

Ascii(333701) = 333701 ^ 1068509 mod 1338817 = 1771
Ascii(59049) = 59049 ^ 1068509 mod 1338817 = 9
Ascii(327067) = 327067 ^ 1068509 mod 1338817 = 72
Ascii(537824) = 537824 ^ 1068509 mod 1338817 = 14
Ascii(1137282) = 1137282 ^ 1068509 mod 1338817 = 19
Ascii(178853) = 178853 ^ 1068509 mod 1338817 = 920
Ascii(1286055) = 1286055 ^ 1068509 mod 1338817 = 120
Ascii(183268) = 183268 ^ 1068509 mod 1338817 = 820
Ascii(535308) = 535308 ^ 1068509 mod 1338817 = 82111
Ascii(19010) = 19010 ^ 1068509 mod 1338817 = 3216
Ascii(592598) = 592598 ^ 1068509 mod 1338817 = 520
Ascii(58063) = 58063 ^ 1068509 mod 1338817 = 821820
Ascii(324526) = 324526 ^ 1068509 mod 1338817 = 1215
Ascii(1171988) = 1171988 ^ 1068509 mod 1338817 = 132
Ascii(1315928) = 1315928 ^ 1068509 mod 1338817 = 200
Ascii(617517) = 617517 ^ 1068509 mod 1338817 = 201
Ascii(769804) = 769804 ^ 1068509 mod 1338817 = 1321
Ascii(974859) = 974859 ^ 1068509 mod 1338817 = 831
Ascii(168019) = 168019 ^ 1068509 mod 1338817 = 97
Ascii(945168) = 945168 ^ 1068509 mod 1338817 = 208
Ascii(1280538) = 1280538 ^ 1068509 mod 1338817 = 20121
Ascii(949282) = 949282 ^ 1068509 mod 1338817 = 51
Ascii(773115) = 773115 ^ 1068509 mod 1338817 = 32174
Ascii(1191266) = 1191266 ^ 1068509 mod 1338817 = 2172
Ascii(261935) = 261935 ^ 1068509 mod 1338817 = 1020
Ascii(1318821) = 1318821 ^ 1068509 mod 1338817 = 52
Ascii(1) = 1 ^ 1068509 mod 1338817 = 1
Ascii(248832) = 248832 ^ 1068509 mod 1338817 = 12
Ascii(537824) = 537824 ^ 1068509 mod 1338817 = 14

-&gt; Original Message in ASCII representation
177197214199201208208211132165208218201215132200201132183197208201215132174217210205211214

-&gt; Original Message
Marcello Alves de Sales Junior	  </PRE><!-- #EndEditable --></TD></TR>
  <TR class=escuro>
    <TD vAlign=top align=left colSpan=2 height=11>
      <DIV align=center><FONT color=#ffffff>® 2000 - 2003. Marcello Alves de 
      Sales Junior <BR>Computer Science - Departamento de Tecnologia da 
      Informação - TCI<BR>Universidade Federal de Alagoas - UFAL - 
      Brazil</FONT></DIV></TD></TR></TBODY></TABLE><!-- #EndTemplate --></BODY></HTML>
